<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    th:replace="~{fragments/layout :: layout(title='İlanlar', content=~{::content})}">

<body>
    <div th:fragment="content">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2><i class="bi bi-megaphone"></i> İlanlar</h2>
            <div class="d-flex gap-2">
                <a href="/listings/sales" class="btn btn-outline-light"><i class="bi bi-bag"></i> Sadece Satılık</a>
                <a href="/listings/rentals" class="btn btn-outline-light"><i class="bi bi-key"></i> Sadece Kiralık</a>
                <a th:if="${isDealer}" href="/listings/new" class="btn btn-accent"><i class="bi bi-plus-lg"></i> İlan
                    Ekle</a>
            </div>
        </div>

        <div class="data-table">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Araç</th>
                        <th>Tip</th>
                        <th>Fiyat</th>
                        <th>Tarih</th>
                        <th>Durum</th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="listing : ${listings}">
                        <td th:text="${listing.id}">-</td>
                        <td th:text="${listing.vehicle?.brand + ' ' + listing.vehicle?.model}">-</td>
                        <td>
                            <span class="badge badge-sale" th:if="${listing.listingType == 'SALE'}">Satılık</span>
                            <span class="badge badge-rental" th:if="${listing.listingType == 'RENTAL'}">Kiralık</span>
                        </td>
                        <td>
                            <span th:if="${listing.listingType == 'SALE'}" th:text="${listing.price + ' ₺'}">-</span>
                            <span th:if="${listing.listingType == 'RENTAL'}"
                                th:text="${listing.dailyRate + ' ₺/gün'}">-</span>
                        </td>
                        <td th:text="${listing.publishDate}">-</td>
                        <td>
                            <span class="badge bg-success" th:if="${listing.isActive}">Aktif</span>
                            <span class="badge bg-secondary" th:unless="${listing.isActive}">Pasif</span>
                        </td>
                        <td>
                            <!-- Galerici Butonları -->
                            <div th:if="${isDealer}">
                                <a th:href="@{/listings/delete/{id}(id=${listing.id})}"
                                    class="btn btn-sm btn-outline-danger" onclick="return confirm('Emin misiniz?')"><i
                                        class="bi bi-trash"></i></a>
                            </div>
                            <!-- Müşteri Butonları -->
                            <div th:unless="${isDealer}">
                                <a th:if="${listing.listingType == 'SALE'}"
                                    th:href="@{/sales/purchase/{id}(id=${listing.id})}"
                                    class="btn btn-sm btn-success"><i class="bi bi-cart-plus"></i> Satın Al</a>
                                <a th:if="${listing.listingType == 'RENTAL'}"
                                    th:href="@{/rentals/rent/{id}(id=${listing.id})}" class="btn btn-sm btn-primary"><i
                                        class="bi bi-key"></i> Kirala</a>
                            </div>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(listings)}">
                        <td colspan="7" class="text-center text-secondary py-4">
                            <span th:if="${isDealer}">İlan bulunamadı. <a href="/listings/new">İlk ilanınızı
                                    oluşturun</a></span>
                            <span th:unless="${isDealer}">Henüz ilan bulunmuyor.</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>

</html>